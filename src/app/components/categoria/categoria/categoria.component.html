<h1>Categorias</h1>


<div class="container-fluid">

    <div class="row">
        <div class="col-7">
            <h2>Listar Categorias</h2>
            @if (!categorias || categorias.length === 0) {
            <i>Nenhuma categoria cadastrada!</i>
            } @else {
            <ng-template #recursiveList let-categorias>
                <ul>
                    <li *ngFor="let cat of categorias">
                        {{ cat.nome }} <button class="btn"
                            (click)="this.setPaiNovaCategoria(cat.categoria_id, cat.nome)"><fa-icon
                                [icon]="faPlus"></fa-icon></button> <button class="btn"
                            (click)="this.delete(cat.categoria_id, cat.nome)"><fa-icon
                                [icon]="faTrash"></fa-icon></button>
                        <ng-container *ngIf="cat.filhos.length > 0">
                            <ng-container
                                *ngTemplateOutlet="recursiveList; context:{ $implicit: cat.filhos }"></ng-container>
                        </ng-container>
                    </li>
                </ul>
            </ng-template>

            <ng-container *ngTemplateOutlet="recursiveList; context:{ $implicit: categorias }"></ng-container>
            }
        </div>
        <div class="col-5">
            <h2>Cadastrar Categoria</h2>
            <form>
                <div class="form-group">
                    <label for="nome">Nome</label>
                    <input type="text" maxlength="25" class="form-control" id="nome" name="nome"
                        [(ngModel)]="novaCategoria.nome" required #inputNome>
                </div>
                <div class="form-group">
                    <label for="Pai">Pai</label>
                    <select id="filtro_pai" class="form-control" name="filtro_pai" [(ngModel)]="novaCategoria.parent_id"
                        disabled="">
                        <option [value]="novaCategoria.parent_id">
                            {{ this.nova_categoria_pai_nome }}
                        </option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filtro_tipo_categoria">Tipo Categoria</label>
                    <select id="filtro_tipo_categoria" class="form-control" name="filtro_tipo_categoria"
                        [(ngModel)]="novaCategoria.tipo_categoria_id">
                        <option *ngFor="let tipoCategoria of tiposCategoria" [value]="tipoCategoria.tipo_categoria_id">
                            {{ tipoCategoria.nome }}
                        </option>
                    </select>
                </div>
                <div class="row mt-2 text-end">
                    <div class="col-md-12">
                        <button type="submit" class="btn btn-primary" (click)="onSubmit()"> Adicionar
                            Categoria</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>